<?php/** * Created by PhpStorm. * User: Addictive * Date: 22/07/2017 * Time: 14:23 */if (!defined("__BOOTFILE__")) { die("Direct access is not allowed!"); }class log {    private $content;    private $stats;    private $timestamp;    private $finalPath;    private $partialPath;    public function getPath() { return $this->partialPath; }    public function __construct($messagesArray, $timestamp, $oldPath) {        $this->content = $messagesArray['content'];        $this->stats = $messagesArray['stats'];        $this->timestamp = $timestamp;        if($oldPath != null) {            $this->finalPath = $oldPath;        }        $this->writeLog();    }    private function writeLog() {        if(!isset($this->finalPath) || empty($this->finalPath)) {            $this->timestamp = str_replace(" ", "_", $this->timestamp);            $this->timestamp = str_replace("/", ".", $this->timestamp);            $this->timestamp = str_replace(":", ".", $this->timestamp);            $this->partialPath = "/logs/" . $this->timestamp . "_import_" . __S('user-username') . ".txt";            $txt = "ERRORS\nLine;Category;Reason;Value\n";            $this->finalPath = $this->partialPath;            file_put_contents(ROOT_PATH . $this->finalPath, $txt, FILE_APPEND);        }        $txt = "";        foreach($this->content as $record) {            if($record['category'] == "error") {                $txt .= $record['line'] . ";" . $record['category'] . ";" . $record['reason'] . ";" . $record['value'] . "\n";            }        }        file_put_contents(ROOT_PATH . $this->finalPath, $txt, FILE_APPEND);    }}?>